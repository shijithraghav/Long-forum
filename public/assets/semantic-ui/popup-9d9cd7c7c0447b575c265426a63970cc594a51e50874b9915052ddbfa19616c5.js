/*!
 * # Semantic UI - Popup
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributors
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
!function(e,t,n,i){"use strict";e.fn.popup=function(a){var o,r=e(this),l=e(n),s=e(t),c=e("body"),d=r.selector||"",u=!0,m=(new Date).getTime(),p=[],h=arguments[0],g="string"==typeof h,f=[].slice.call(arguments,1);return r.each(function(){var n,r,b,v,T,E=e.isPlainObject(a)?e.extend(!0,{},e.fn.popup.settings,a):e.extend({},e.fn.popup.settings),y=E.selector,C=E.className,k=E.error,I=E.metadata,D=E.namespace,R="."+E.namespace,O="module-"+D,w=e(this),S=e(E.context),_=E.target?e(E.target):w,A=0,x=!1,K=!1,L=this,N=w.data(O);T={initialize:function(){T.debug("Initializing",w),T.createID(),T.bind.events(),!T.exists()&&E.preserve&&T.create(),T.instantiate()},instantiate:function(){T.verbose("Storing instance",T),N=T,w.data(O,N)},refresh:function(){E.popup?n=e(E.popup).eq(0):E.inline&&(n=_.nextAll(y.popup).eq(0),E.popup=n),E.popup?(n.addClass(C.loading),r=T.get.offsetParent(),n.removeClass(C.loading),E.movePopup&&T.has.popup()&&T.get.offsetParent(n)[0]!==r[0]&&(T.debug("Moving popup to the same offset parent as activating element"),n.detach().appendTo(r))):r=E.inline?T.get.offsetParent(_):T.has.popup()?T.get.offsetParent(n):c,r.is("html")&&r[0]!==c[0]&&(T.debug("Setting page as offset parent"),r=c),T.get.variation()&&T.set.variation()},reposition:function(){T.refresh(),T.set.position()},destroy:function(){T.debug("Destroying previous module"),n&&!E.preserve&&T.removePopup(),clearTimeout(T.hideTimer),clearTimeout(T.showTimer),s.off(b),w.off(R).removeData(O)},event:{start:function(t){var n=e.isPlainObject(E.delay)?E.delay.show:E.delay;clearTimeout(T.hideTimer),K||(T.showTimer=setTimeout(T.show,n))},end:function(){var t=e.isPlainObject(E.delay)?E.delay.hide:E.delay;clearTimeout(T.showTimer),T.hideTimer=setTimeout(T.hide,t)},touchstart:function(e){K=!0,T.show()},resize:function(){T.is.visible()&&T.set.position()},hideGracefully:function(t){t&&0===e(t.target).closest(y.popup).length?(T.debug("Click occurred outside popup hiding popup"),T.hide()):T.debug("Click was inside popup, keeping popup open")}},create:function(){var t=T.get.html(),i=T.get.title(),a=T.get.content();t||a||i?(T.debug("Creating pop-up html"),t||(t=E.templates.popup({title:i,content:a})),n=e("<div/>").addClass(C.popup).data(I.activator,w).html(t),E.inline?(T.verbose("Inserting popup element inline",n),n.insertAfter(w)):(T.verbose("Appending popup element to body",n),n.appendTo(S)),T.refresh(),T.set.variation(),E.hoverable&&T.bind.popup(),E.onCreate.call(n,L)):0!==_.next(y.popup).length?(T.verbose("Pre-existing popup found"),E.inline=!0,E.popups=_.next(y.popup).data(I.activator,w),T.refresh(),E.hoverable&&T.bind.popup()):E.popup?(e(E.popup).data(I.activator,w),T.verbose("Used popup specified in settings"),T.refresh(),E.hoverable&&T.bind.popup()):T.debug("No content specified skipping display",L)},createID:function(){v=(Math.random().toString(16)+"000000000").substr(2,8),b="."+v,T.verbose("Creating unique id for element",v)},toggle:function(){T.debug("Toggling pop-up"),T.is.hidden()?(T.debug("Popup is hidden, showing pop-up"),T.unbind.close(),T.show()):(T.debug("Popup is visible, hiding pop-up"),T.hide())},show:function(e){if(e=e||function(){},T.debug("Showing pop-up",E.transition),T.is.hidden()&&(!T.is.active()||!T.is.dropdown())){if(T.exists()||T.create(),E.onShow.call(n,L)===!1)return void T.debug("onShow callback returned false, cancelling popup animation");E.preserve||E.popup||T.refresh(),n&&T.set.position()&&(T.save.conditions(),E.exclusive&&T.hideAll(),T.animate.show(e))}},hide:function(e){if(e=e||function(){},T.is.visible()||T.is.animating()){if(E.onHide.call(n,L)===!1)return void T.debug("onHide callback returned false, cancelling popup animation");T.remove.visible(),T.unbind.close(),T.restore.conditions(),T.animate.hide(e)}},hideAll:function(){e(y.popup).filter("."+C.visible).each(function(){e(this).data(I.activator).popup("hide")})},exists:function(){return n?E.inline||E.popup?T.has.popup():n.closest(S).length>=1?!0:!1:!1},removePopup:function(){T.has.popup()&&!E.popup&&(T.debug("Removing popup",n),n.remove(),n=i,E.onRemove.call(n,L))},save:{conditions:function(){T.cache={title:w.attr("title")},T.cache.title&&w.removeAttr("title"),T.verbose("Saving original attributes",T.cache.title)}},restore:{conditions:function(){return T.cache&&T.cache.title&&(w.attr("title",T.cache.title),T.verbose("Restoring original attributes",T.cache.title)),!0}},animate:{show:function(t){t=e.isFunction(t)?t:function(){},E.transition&&e.fn.transition!==i&&w.transition("is supported")?(T.set.visible(),n.transition({animation:E.transition+" in",queue:!1,debug:E.debug,verbose:E.verbose,duration:E.duration,onComplete:function(){T.bind.close(),t.call(n,L),E.onVisible.call(n,L)}})):T.error(k.noTransition)},hide:function(t){return t=e.isFunction(t)?t:function(){},T.debug("Hiding pop-up"),E.onHide.call(n,L)===!1?void T.debug("onHide callback returned false, cancelling popup animation"):void(E.transition&&e.fn.transition!==i&&w.transition("is supported")?n.transition({animation:E.transition+" out",queue:!1,duration:E.duration,debug:E.debug,verbose:E.verbose,onComplete:function(){T.reset(),t.call(n,L),E.onHidden.call(n,L)}}):T.error(k.noTransition))}},get:{html:function(){return w.removeData(I.html),w.data(I.html)||E.html},title:function(){return w.removeData(I.title),w.data(I.title)||E.title},content:function(){return w.removeData(I.content),w.data(I.content)||w.attr("title")||E.content},variation:function(){return w.removeData(I.variation),w.data(I.variation)||E.variation},popupOffset:function(){return n.offset()},calculations:function(){var e,i=_[0],a=E.inline||E.popup?_.position():_.offset(),o={};return o={target:{element:_[0],width:_.outerWidth(),height:_.outerHeight(),top:a.top,left:a.left,margin:{}},popup:{width:n.outerWidth(),height:n.outerHeight()},parent:{width:r.outerWidth(),height:r.outerHeight()},screen:{scroll:{top:s.scrollTop(),left:s.scrollLeft()},width:s.width(),height:s.height()}},E.setFluidWidth&&T.is.fluid()&&(o.container={width:n.parent().outerWidth()},o.popup.width=o.container.width),o.target.margin.top=E.inline?parseInt(t.getComputedStyle(i).getPropertyValue("margin-top"),10):0,o.target.margin.left=E.inline?T.is.rtl()?parseInt(t.getComputedStyle(i).getPropertyValue("margin-right"),10):parseInt(t.getComputedStyle(i).getPropertyValue("margin-left"),10):0,e=o.screen,o.boundary={top:e.scroll.top,bottom:e.scroll.top+e.height,left:e.scroll.left,right:e.scroll.left+e.width},o},id:function(){return v},startEvent:function(){return"hover"==E.on?"mouseenter":"focus"==E.on?"focus":!1},scrollEvent:function(){return"scroll"},endEvent:function(){return"hover"==E.on?"mouseleave":"focus"==E.on?"blur":!1},distanceFromBoundary:function(e,t){var n,i,a={};return e=e||T.get.offset(),t=t||T.get.calculations(),n=t.popup,i=t.boundary,e&&(a={top:e.top-i.top,left:e.left-i.left,right:i.right-(e.left+n.width),bottom:i.bottom-(e.top+n.height)},T.verbose("Distance from boundaries determined",e,a)),a},offsetParent:function(t){var n=t!==i?t[0]:w[0],a=n.parentNode,o=e(a);if(a)for(var r="none"===o.css("transform"),l="static"===o.css("position"),s=o.is("html");a&&!s&&l&&r;)a=a.parentNode,o=e(a),r="none"===o.css("transform"),l="static"===o.css("position"),s=o.is("html");return o&&o.length>0?o:e()},positions:function(){return{"top left":!1,"top center":!1,"top right":!1,"bottom left":!1,"bottom center":!1,"bottom right":!1,"left center":!1,"right center":!1}},nextPosition:function(e){var t=e.split(" "),n=t[0],i=t[1],a={top:"bottom",bottom:"top",left:"right",right:"left"},o={left:"center",center:"right",right:"left"},r={"top left":"top center","top center":"top right","top right":"right center","right center":"bottom right","bottom right":"bottom center","bottom center":"bottom left","bottom left":"left center","left center":"top left"},l="top"==n||"bottom"==n,s=!1,c=!1,d=!1;return x||(T.verbose("All available positions available"),x=T.get.positions()),T.debug("Recording last position tried",e),x[e]=!0,"opposite"===E.prefer&&(d=[a[n],i],d=d.join(" "),s=x[d]===!0,T.debug("Trying opposite strategy",d)),"adjacent"===E.prefer&&l&&(d=[n,o[i]],d=d.join(" "),c=x[d]===!0,T.debug("Trying adjacent strategy",d)),(c||s)&&(T.debug("Using backup position",d),d=r[e]),d}},set:{position:function(e,t){if(0===_.length||0===n.length)return void T.error(k.notFound);var a,o,r,l,s,c,d,u;if(t=t||T.get.calculations(),e=e||w.data(I.position)||E.position,a=w.data(I.offset)||E.offset,o=E.distanceAway,r=t.target,l=t.popup,s=t.parent,0===r.width&&0===r.height)return T.debug("Popup target is hidden, no action taken"),!1;switch(E.inline&&(T.debug("Adding margin to calculation",r.margin),"left center"==e||"right center"==e?(a+=r.margin.top,o+=-r.margin.left):"top left"==e||"top center"==e||"top right"==e?(a+=r.margin.left,o-=r.margin.top):(a+=r.margin.left,o+=r.margin.top)),T.debug("Determining popup position from calculations",e,t),T.is.rtl()&&(e=e.replace(/left|right/g,function(e){return"left"==e?"right":"left"}),T.debug("RTL: Popup position updated",e)),A==E.maxSearchDepth&&"string"==typeof E.lastResort&&(e=E.lastResort),e){case"top left":c={top:"auto",bottom:s.height-r.top+o,left:r.left+a,right:"auto"};break;case"top center":c={bottom:s.height-r.top+o,left:r.left+r.width/2-l.width/2+a,top:"auto",right:"auto"};break;case"top right":c={bottom:s.height-r.top+o,right:s.width-r.left-r.width-a,top:"auto",left:"auto"};break;case"left center":c={top:r.top+r.height/2-l.height/2+a,right:s.width-r.left+o,left:"auto",bottom:"auto"};break;case"right center":c={top:r.top+r.height/2-l.height/2+a,left:r.left+r.width+o,bottom:"auto",right:"auto"};break;case"bottom left":c={top:r.top+r.height+o,left:r.left+a,bottom:"auto",right:"auto"};break;case"bottom center":c={top:r.top+r.height+o,left:r.left+r.width/2-l.width/2+a,bottom:"auto",right:"auto"};break;case"bottom right":c={top:r.top+r.height+o,right:s.width-r.left-r.width-a,left:"auto",bottom:"auto"}}if(c===i&&T.error(k.invalidPosition,e),T.debug("Calculated popup positioning values",c),n.css(c).removeClass(C.position).addClass(e).addClass(C.loading),d=T.get.popupOffset(),u=T.get.distanceFromBoundary(d,t),T.is.offstage(u,e)){if(T.debug("Position is outside viewport",e),A<E.maxSearchDepth)return A++,e=T.get.nextPosition(e),T.debug("Trying new position",e),n?T.set.position(e,t):!1;if(!E.lastResort)return T.debug("Popup could not find a position to display",n),T.error(k.cannotPlace,L),T.remove.attempts(),T.remove.loading(),T.reset(),!1;T.debug("No position found, showing with last position")}return T.debug("Position is on stage",e),T.remove.attempts(),T.remove.loading(),E.setFluidWidth&&T.is.fluid()&&T.set.fluidWidth(t),!0},fluidWidth:function(e){e=e||T.get.calculations(),T.debug("Automatically setting element width to parent width",e.parent.width),n.css("width",e.container.width)},variation:function(e){e=e||T.get.variation(),e&&T.has.popup()&&(T.verbose("Adding variation to popup",e),n.addClass(e))},visible:function(){w.addClass(C.visible)}},remove:{loading:function(){n.removeClass(C.loading)},variation:function(e){e=e||T.get.variation(),e&&(T.verbose("Removing variation",e),n.removeClass(e))},visible:function(){w.removeClass(C.visible)},attempts:function(){T.verbose("Resetting all searched positions"),A=0,x=!1}},bind:{events:function(){T.debug("Binding popup events to module"),"click"==E.on&&w.on("click"+R,T.toggle),"hover"==E.on&&u&&w.on("touchstart"+R,T.event.touchstart),T.get.startEvent()&&w.on(T.get.startEvent()+R,T.event.start).on(T.get.endEvent()+R,T.event.end),E.target&&T.debug("Target set to element",_),s.on("resize"+b,T.event.resize)},popup:function(){T.verbose("Allowing hover events on popup to prevent closing"),n&&T.has.popup()&&n.on("mouseenter"+R,T.event.start).on("mouseleave"+R,T.event.end)},close:function(){(E.hideOnScroll===!0||"auto"==E.hideOnScroll&&"click"!=E.on)&&(l.one(T.get.scrollEvent()+b,T.event.hideGracefully),S.one(T.get.scrollEvent()+b,T.event.hideGracefully)),"hover"==E.on&&K&&(T.verbose("Binding popup close event to document"),l.on("touchstart"+b,function(e){T.verbose("Touched away from popup"),T.event.hideGracefully.call(L,e)})),"click"==E.on&&E.closable&&(T.verbose("Binding popup close event to document"),l.on("click"+b,function(e){T.verbose("Clicked away from popup"),T.event.hideGracefully.call(L,e)}))}},unbind:{close:function(){(E.hideOnScroll===!0||"auto"==E.hideOnScroll&&"click"!=E.on)&&(l.off("scroll"+b,T.hide),S.off("scroll"+b,T.hide)),"hover"==E.on&&K&&(l.off("touchstart"+b),K=!1),"click"==E.on&&E.closable&&(T.verbose("Removing close event from document"),l.off("click"+b))}},has:{popup:function(){return n&&n.length>0}},is:{offstage:function(t,n){var i=[];return e.each(t,function(e,t){t<-E.jitter&&(T.debug("Position exceeds allowable distance from edge",e,t,n),i.push(e))}),i.length>0?!0:!1},active:function(){return w.hasClass(C.active)},animating:function(){return n&&n.hasClass(C.animating)},fluid:function(){return n&&n.hasClass(C.fluid)},visible:function(){return n&&n.hasClass(C.visible)},dropdown:function(){return w.hasClass(C.dropdown)},hidden:function(){return!T.is.visible()},rtl:function(){return"rtl"==w.css("direction")}},reset:function(){T.remove.visible(),E.preserve?e.fn.transition!==i&&n.transition("remove transition"):T.removePopup()},setting:function(t,n){if(e.isPlainObject(t))e.extend(!0,E,t);else{if(n===i)return E[t];E[t]=n}},internal:function(t,n){if(e.isPlainObject(t))e.extend(!0,T,t);else{if(n===i)return T[t];T[t]=n}},debug:function(){E.debug&&(E.performance?T.performance.log(arguments):(T.debug=Function.prototype.bind.call(console.info,console,E.name+":"),T.debug.apply(console,arguments)))},verbose:function(){E.verbose&&E.debug&&(E.performance?T.performance.log(arguments):(T.verbose=Function.prototype.bind.call(console.info,console,E.name+":"),T.verbose.apply(console,arguments)))},error:function(){T.error=Function.prototype.bind.call(console.error,console,E.name+":"),T.error.apply(console,arguments)},performance:{log:function(e){var t,n,i;E.performance&&(t=(new Date).getTime(),i=m||t,n=t-i,m=t,p.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:L,"Execution Time":n})),clearTimeout(T.performance.timer),T.performance.timer=setTimeout(T.performance.display,500)},display:function(){var t=E.name+":",n=0;m=!1,clearTimeout(T.performance.timer),e.each(p,function(e,t){n+=t["Execution Time"]}),t+=" "+n+"ms",d&&(t+=" '"+d+"'"),(console.group!==i||console.table!==i)&&p.length>0&&(console.groupCollapsed(t),console.table?console.table(p):e.each(p,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),p=[]}},invoke:function(t,n,a){var r,l,s,c=N;return n=n||f,a=L||a,"string"==typeof t&&c!==i&&(t=t.split(/[\. ]/),r=t.length-1,e.each(t,function(n,a){var o=n!=r?a+t[n+1].charAt(0).toUpperCase()+t[n+1].slice(1):t;if(e.isPlainObject(c[o])&&n!=r)c=c[o];else{if(c[o]!==i)return l=c[o],!1;if(!e.isPlainObject(c[a])||n==r)return c[a]!==i?(l=c[a],!1):!1;c=c[a]}})),e.isFunction(l)?s=l.apply(a,n):l!==i&&(s=l),e.isArray(o)?o.push(s):o!==i?o=[o,s]:s!==i&&(o=s),l}},g?(N===i&&T.initialize(),T.invoke(h)):(N!==i&&N.invoke("destroy"),T.initialize())}),o!==i?o:this},e.fn.popup.settings={name:"Popup",debug:!1,verbose:!1,performance:!0,namespace:"popup",onCreate:function(){},onRemove:function(){},onShow:function(){},onVisible:function(){},onHide:function(){},onHidden:function(){},on:"hover",addTouchEvents:!0,position:"top left",variation:"",movePopup:!0,target:!1,popup:!1,inline:!1,preserve:!1,hoverable:!1,content:!1,html:!1,title:!1,closable:!0,hideOnScroll:"auto",exclusive:!1,context:"body",prefer:"opposite",lastResort:!1,delay:{show:50,hide:70},setFluidWidth:!0,duration:200,transition:"scale",distanceAway:0,jitter:2,offset:0,maxSearchDepth:15,error:{invalidPosition:"The position you specified is not a valid position",cannotPlace:"Popup does not fit within the boundaries of the viewport",method:"The method you called is not defined.",noTransition:"This module requires ui transitions <https://github.com/Semantic-Org/UI-Transition>",notFound:"The target or popup you specified does not exist on the page"},metadata:{activator:"activator",content:"content",html:"html",offset:"offset",position:"position",title:"title",variation:"variation"},className:{active:"active",animating:"animating",dropdown:"dropdown",fluid:"fluid",loading:"loading",popup:"ui popup",position:"top left center bottom right",visible:"visible"},selector:{popup:".ui.popup"},templates:{escape:function(e){var t=/[&<>"'`]/g,n=/[&<>"'`]/,i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},a=function(e){return i[e]};return n.test(e)?e.replace(t,a):e},popup:function(t){var n="",a=e.fn.popup.settings.templates.escape;return typeof t!==i&&(typeof t.title!==i&&t.title&&(t.title=a(t.title),n+='<div class="header">'+t.title+"</div>"),typeof t.content!==i&&t.content&&(t.content=a(t.content),n+='<div class="content">'+t.content+"</div>")),n}}}}(jQuery,window,document);