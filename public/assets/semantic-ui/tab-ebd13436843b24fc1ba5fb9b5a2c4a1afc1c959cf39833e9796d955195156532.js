/*!
 * # Semantic UI - Tab
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributors
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
!function(e,t,n,i){"use strict";e.fn.tab=function(a){var o,r=e(e.isFunction(this)?t:this),l=r.selector||"",s=(new Date).getTime(),c=[],d=arguments[0],u="string"==typeof d,m=[].slice.call(arguments,1),p=!1;return r.each(function(){var h,g,f,b,v,T,E=e.isPlainObject(a)?e.extend(!0,{},e.fn.tab.settings,a):e.extend({},e.fn.tab.settings),y=E.className,C=E.metadata,k=E.selector,I=E.error,D="."+E.namespace,R="module-"+E.namespace,O=e(this),w={},S=!0,A=0,_=this,x=O.data(R);v={initialize:function(){v.debug("Initializing tab menu item",O),v.fix.callbacks(),v.determineTabs(),v.debug("Determining tabs",E.context,g),E.auto&&v.set.auto(),v.bind.events(),E.history&&!p&&(v.initializeHistory(),p=!0),v.instantiate()},instantiate:function(){v.verbose("Storing instance of module",v),x=v,O.data(R,v)},destroy:function(){v.debug("Destroying tabs",O),O.removeData(R).off(D)},bind:{events:function(){e.isWindow(_)||(v.debug("Attaching tab activation events to element",O),O.on("click"+D,v.event.click))}},determineTabs:function(){var t;"parent"===E.context?(O.closest(k.ui).length>0?(t=O.closest(k.ui),v.verbose("Using closest UI element as parent",t)):t=O,h=t.parent(),v.verbose("Determined parent element for creating context",h)):E.context?(h=e(E.context),v.verbose("Using selector for tab context",E.context,h)):h=e("body"),E.childrenOnly?(g=h.children(k.tabs),v.debug("Searching tab context children for tabs",h,g)):(g=h.find(k.tabs),v.debug("Searching tab context for tabs",h,g))},fix:{callbacks:function(){e.isPlainObject(a)&&(a.onTabLoad||a.onTabInit)&&(a.onTabLoad&&(a.onLoad=a.onTabLoad,delete a.onTabLoad,v.error(I.legacyLoad,a.onLoad)),a.onTabInit&&(a.onFirstLoad=a.onTabInit,delete a.onTabInit,v.error(I.legacyInit,a.onFirstLoad)),E=e.extend(!0,{},e.fn.tab.settings,a))}},initializeHistory:function(){if(v.debug("Initializing page state"),e.address===i)return v.error(I.state),!1;if("state"==E.historyType){if(v.debug("Using HTML5 to manage state"),E.path===!1)return v.error(I.path),!1;e.address.history(!0).state(E.path)}e.address.bind("change",v.event.history.change)},event:{click:function(t){var n=e(this).data(C.tab);n!==i?(E.history?(v.verbose("Updating page state",t),e.address.value(n)):(v.verbose("Changing tab",t),v.changeTab(n)),t.preventDefault()):v.debug("No tab specified")},history:{change:function(t){var n=t.pathNames.join("/")||v.get.initialPath(),a=E.templates.determineTitle(n)||!1;v.performance.display(),v.debug("History change event",n,t),T=t,n!==i&&v.changeTab(n),a&&e.address.title(a)}}},refresh:function(){f&&(v.debug("Refreshing tab",f),v.changeTab(f))},cache:{read:function(e){return e!==i?w[e]:!1},add:function(e,t){e=e||f,v.debug("Adding cached content for",e),w[e]=t},remove:function(e){e=e||f,v.debug("Removing cached content for",e),delete w[e]}},set:{auto:function(){var t="string"==typeof E.path?E.path.replace(/\/$/,"")+"/{$tab}":"/{$tab}";v.verbose("Setting up automatic tab retrieval from server",t),e.isPlainObject(E.apiSettings)?E.apiSettings.url=t:E.apiSettings={url:t}},loading:function(e){var t=v.get.tabElement(e),n=t.hasClass(y.loading);n||(v.verbose("Setting loading state for",t),t.addClass(y.loading).siblings(g).removeClass(y.active+" "+y.loading),t.length>0&&E.onRequest.call(t[0],e))},state:function(t){e.address.value(t)}},changeTab:function(n){var i=t.history&&t.history.pushState,a=i&&E.ignoreFirstLoad&&S,o=E.auto||e.isPlainObject(E.apiSettings),r=o&&!a?v.utilities.pathToArray(n):v.get.defaultPathArray(n);n=v.utilities.arrayToPath(r),e.each(r,function(t,i){var l,s,c,d,u=r.slice(0,t+1),m=v.utilities.arrayToPath(u),p=v.is.tab(m),g=t+1==r.length,k=v.get.tabElement(m);if(v.verbose("Looking for tab",i),p){if(v.verbose("Tab was found",i),f=m,b=v.utilities.filterArray(r,u),g?d=!0:(s=r.slice(0,t+2),c=v.utilities.arrayToPath(s),d=!v.is.tab(c),d&&v.verbose("Tab parameters found",s)),d&&o)return a?(v.debug("Ignoring remote content on first tab load",m),S=!1,v.cache.add(n,k.html()),v.activate.all(m),E.onFirstLoad.call(k[0],m,b,T),E.onLoad.call(k[0],m,b,T)):(v.activate.navigation(m),v.fetch.content(m,n)),!1;v.debug("Opened local tab",m),v.activate.all(m),v.cache.read(m)||(v.cache.add(m,!0),v.debug("First time tab loaded calling tab init"),E.onFirstLoad.call(k[0],m,b,T)),E.onLoad.call(k[0],m,b,T)}else{if(-1!=n.search("/")||""===n)return v.error(I.missingTab,O,h,m),!1;if(l=e("#"+n+', a[name="'+n+'"]'),m=l.closest("[data-tab]").data(C.tab),k=v.get.tabElement(m),l&&l.length>0&&m)return v.debug("Anchor link used, opening parent tab",k,l),k.hasClass(y.active)||setTimeout(function(){v.scrollTo(l)},0),v.activate.all(m),v.cache.read(m)||(v.cache.add(m,!0),v.debug("First time tab loaded calling tab init"),E.onFirstLoad.call(k[0],m,b,T)),E.onLoad.call(k[0],m,b,T),!1}})},scrollTo:function(t){var i=t&&t.length>0?t.offset().top:!1;i!==!1&&(v.debug("Forcing scroll to an in-page link in a hidden tab",i,t),e(n).scrollTop(i))},update:{content:function(e,t,n){var a=v.get.tabElement(e),o=a[0];n=n!==i?n:E.evaluateScripts,n?(v.debug("Updating HTML and evaluating inline scripts",e,t),a.html(t)):(v.debug("Updating HTML",e,t),o.innerHTML=t)}},fetch:{content:function(t,n){var a,o,r=v.get.tabElement(t),l={dataType:"html",encodeParameters:!1,on:"now",cache:E.alwaysRefresh,headers:{"X-Remote":!0},onSuccess:function(e){v.cache.add(n,e),v.update.content(t,e),t==f?(v.debug("Content loaded",t),v.activate.tab(t)):v.debug("Content loaded in background",t),E.onFirstLoad.call(r[0],t,b,T),E.onLoad.call(r[0],t,b,T)},urlData:{tab:n}},s=r.api("get request")||!1,c=s&&"pending"===s.state();n=n||t,o=v.cache.read(n),E.cache&&o?(v.activate.tab(t),v.debug("Adding cached content",n),"once"==E.evaluateScripts?v.update.content(t,o,!1):v.update.content(t,o),E.onLoad.call(r[0],t,b,T)):c?(v.set.loading(t),v.debug("Content is already loading",n)):e.api!==i?(a=e.extend(!0,{},E.apiSettings,l),v.debug("Retrieving remote content",n,a),v.set.loading(t),r.api(a)):v.error(I.api)}},activate:{all:function(e){v.activate.tab(e),v.activate.navigation(e)},tab:function(e){var t=v.get.tabElement(e),n=t.hasClass(y.active);v.verbose("Showing tab content for",t),n||(t.addClass(y.active).siblings(g).removeClass(y.active+" "+y.loading),t.length>0&&E.onVisible.call(t[0],e))},navigation:function(e){var t=v.get.navElement(e),n=t.hasClass(y.active);v.verbose("Activating tab navigation for",t,e),n||t.addClass(y.active).siblings(r).removeClass(y.active+" "+y.loading)}},deactivate:{all:function(){v.deactivate.navigation(),v.deactivate.tabs()},navigation:function(){r.removeClass(y.active)},tabs:function(){g.removeClass(y.active+" "+y.loading)}},is:{tab:function(e){return e!==i?v.get.tabElement(e).length>0:!1}},get:{initialPath:function(){return r.eq(0).data(C.tab)||g.eq(0).data(C.tab)},path:function(){return e.address.value()},defaultPathArray:function(e){return v.utilities.pathToArray(v.get.defaultPath(e))},defaultPath:function(e){var t=r.filter("[data-"+C.tab+'^="'+e+'/"]').eq(0),n=t.data(C.tab)||!1;if(n){if(v.debug("Found default tab",n),A<E.maxDepth)return A++,v.get.defaultPath(n);v.error(I.recursion)}else v.debug("No default tabs found for",e,g);return A=0,e},navElement:function(e){return e=e||f,r.filter("[data-"+C.tab+'="'+e+'"]')},tabElement:function(e){var t,n,i,a;return e=e||f,i=v.utilities.pathToArray(e),a=v.utilities.last(i),t=g.filter("[data-"+C.tab+'="'+e+'"]'),n=g.filter("[data-"+C.tab+'="'+a+'"]'),t.length>0?t:n},tab:function(){return f}},utilities:{filterArray:function(t,n){return e.grep(t,function(t){return-1==e.inArray(t,n)})},last:function(t){return e.isArray(t)?t[t.length-1]:!1},pathToArray:function(e){return e===i&&(e=f),"string"==typeof e?e.split("/"):[e]},arrayToPath:function(t){return e.isArray(t)?t.join("/"):!1}},setting:function(t,n){if(v.debug("Changing setting",t,n),e.isPlainObject(t))e.extend(!0,E,t);else{if(n===i)return E[t];E[t]=n}},internal:function(t,n){if(e.isPlainObject(t))e.extend(!0,v,t);else{if(n===i)return v[t];v[t]=n}},debug:function(){E.debug&&(E.performance?v.performance.log(arguments):(v.debug=Function.prototype.bind.call(console.info,console,E.name+":"),v.debug.apply(console,arguments)))},verbose:function(){E.verbose&&E.debug&&(E.performance?v.performance.log(arguments):(v.verbose=Function.prototype.bind.call(console.info,console,E.name+":"),v.verbose.apply(console,arguments)))},error:function(){v.error=Function.prototype.bind.call(console.error,console,E.name+":"),v.error.apply(console,arguments)},performance:{log:function(e){var t,n,i;E.performance&&(t=(new Date).getTime(),i=s||t,n=t-i,s=t,c.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:_,"Execution Time":n})),clearTimeout(v.performance.timer),v.performance.timer=setTimeout(v.performance.display,500)},display:function(){var t=E.name+":",n=0;s=!1,clearTimeout(v.performance.timer),e.each(c,function(e,t){n+=t["Execution Time"]}),t+=" "+n+"ms",l&&(t+=" '"+l+"'"),(console.group!==i||console.table!==i)&&c.length>0&&(console.groupCollapsed(t),console.table?console.table(c):e.each(c,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),c=[]}},invoke:function(t,n,a){var r,l,s,c=x;return n=n||m,a=_||a,"string"==typeof t&&c!==i&&(t=t.split(/[\. ]/),r=t.length-1,e.each(t,function(n,a){var o=n!=r?a+t[n+1].charAt(0).toUpperCase()+t[n+1].slice(1):t;if(e.isPlainObject(c[o])&&n!=r)c=c[o];else{if(c[o]!==i)return l=c[o],!1;if(!e.isPlainObject(c[a])||n==r)return c[a]!==i?(l=c[a],!1):(v.error(I.method,t),!1);c=c[a]}})),e.isFunction(l)?s=l.apply(a,n):l!==i&&(s=l),e.isArray(o)?o.push(s):o!==i?o=[o,s]:s!==i&&(o=s),l}},u?(x===i&&v.initialize(),v.invoke(d)):(x!==i&&x.invoke("destroy"),v.initialize())}),o!==i?o:this},e.tab=function(){e(t).tab.apply(this,arguments)},e.fn.tab.settings={name:"Tab",namespace:"tab",debug:!1,verbose:!1,performance:!0,auto:!1,history:!1,historyType:"hash",path:!1,context:!1,childrenOnly:!1,maxDepth:25,alwaysRefresh:!1,cache:!0,ignoreFirstLoad:!1,apiSettings:!1,evaluateScripts:"once",onFirstLoad:function(e,t,n){},onLoad:function(e,t,n){},onVisible:function(e,t,n){},onRequest:function(e,t,n){},templates:{determineTitle:function(e){}},error:{api:"You attempted to load content without API module",method:"The method you called is not defined",missingTab:"Activated tab cannot be found. Tabs are case-sensitive.",noContent:"The tab you specified is missing a content url.",path:"History enabled, but no path was specified",recursion:"Max recursive depth reached",legacyInit:"onTabInit has been renamed to onFirstLoad in 2.0, please adjust your code.",legacyLoad:"onTabLoad has been renamed to onLoad in 2.0. Please adjust your code",state:"History requires Asual's Address library <https://github.com/asual/jquery-address>"},metadata:{tab:"tab",loaded:"loaded",promise:"promise"},className:{loading:"loading",active:"active"},selector:{tabs:".ui.tab",ui:".ui"}}}(jQuery,window,document);